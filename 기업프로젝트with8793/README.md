# Find Font

DAGACHI X 8793 Project

사용자가 업로드한 이미지와 가장 유사한 폰트를 확인하는 모델 구현

### Used Libraries
```
tensorflow == 1.13.1
keras == 2.2.4
h5py == 2.10.0
tqdm
matplotlib
numpy
PIL
cv2
itertools
random
imutils
os
sklearn
```

### Train / Test Data
알파벳 대소문자, 숫자, 특수문자(총 70개)를 중복되지 않게 무작위 배치하여 3-6자 사이의 이미지로 생성하였다.
또한 TTF 파일 1개 당 4배수의 이미지를 생성하여 학습 능률을 강화하였다. 

### Training Model
DeepFont 논문 및 해당 모델을 참고하였다.

1. 이미지 증폭  
길이 조합의 모든 경우의 수를 구하는 itertools 라이브러리의 combinations을 이용하여 학습 이미지에 노이즈, 블러, affine 변환, 그라데이션을 적용하였다.


2. 학습  
이용한 ttf 파일 : 30개  
batch size : 64  
epoch : 20  
최종 accuracy : 0.97
```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 58, 58, 64)        147520    
_________________________________________________________________
batch_normalization_1 (Batch (None, 58, 58, 64)        256       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 29, 29, 64)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 6, 6, 128)         4718720   
_________________________________________________________________
batch_normalization_2 (Batch (None, 6, 6, 128)         512       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 3, 3, 128)         0         
_________________________________________________________________
conv2d_transpose_1 (Conv2DTr (None, 6, 6, 128)         9437312   
_________________________________________________________________
up_sampling2d_1 (UpSampling2 (None, 12, 12, 128)       0         
_________________________________________________________________
conv2d_transpose_2 (Conv2DTr (None, 24, 24, 64)        1179712   
_________________________________________________________________
up_sampling2d_2 (UpSampling2 (None, 48, 48, 64)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 37, 37, 256)       2359552   
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 26, 26, 256)       9437440   
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 15, 15, 256)       9437440   
_________________________________________________________________
flatten_1 (Flatten)          (None, 57600)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 4096)              235933696 
_________________________________________________________________
dropout_1 (Dropout)          (None, 4096)              0         
_________________________________________________________________
dense_2 (Dense)              (None, 4096)              16781312  
_________________________________________________________________
dropout_2 (Dropout)          (None, 4096)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 2383)              9763151   
_________________________________________________________________
dense_4 (Dense)              (None, 70)                166880    
=================================================================
Total params: 299,363,503
Trainable params: 299,363,119
Non-trainable params: 384
_________________________________________________________________
```

### Result
학습 결과를 토대로 테스트를 진행한 단어와 해당 단어와 비슷한 모양의 폰트명 3가지를 순차적으로 출력한다.

### Feedback
Google Colab Pro+를 이용하여 학습을 진행하였으나 제공되는 RAM과 Runtime의 제약으로 많은 수의 폰트를 학습하지 못하였다.
하지만 적은 epoch과 batchsize에도 불구하고 결과적으로 좋은 정확도를 획득했기 때문에 컴퓨팅 자원을 보완하면 더 많은 폰트 학습도 성공적으로 진행 할 수 있을 것으로 보인다.


### 참고
Zhangyang Wang, Jianchao Yang, Hailin Jin, Eli Shechtman, Aseem Agarwala, Jonathan Brandt, Thomas S. Huang(2015). DeepFont: Identify Your Font from An Image. MM’15, October 26–30, 2015, Brisbane, Australia.  
https://github.com/robinreni96/Font_Recognition-DeepFont.git
